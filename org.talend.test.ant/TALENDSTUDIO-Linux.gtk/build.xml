<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="main" name="TALEND">
	<description>Application RCP Building</description>

	<!-- set global properties for this build -->
	<property name="author" value="Talend" />
	<property name="project" value="Application RCP" />
	<property name="bupdatesite" value="false" />
	
	<!-- Directory Structure properties -->
	<property name="releasedir" location="${basedir}/Talend/" />
	<property name="storage" location="${basedir}/Storage/" />
	<property name="storage.sources" location="${storage}/Sources" />
	<property name="storage.sources.dirname" value="Sources" />
	<property name="storage.sources.filename" value="Sources" />
	<property name="storage.builds" location="${storage}/Builds" />
	<property name="storage.builds.dirname" value="TOS" />
	<property name="storage.builds.filename" value="TOS" />
	<property name="storage.builds.os" value="Unix" />
	<property name="backup" location="${basedir}/Backup/" />
	<property name="backup.sources" location="${backup}/Sources" />
	<property name="backup.builds" location="${backup}/Builds" />
	<property name="src" location="${basedir}/src/" />
	<property name="doc" location="${basedir}/doc/" />
	<property name="srcfeatures" location="${src}/features" />
	<property name="srcplugins" location="${src}/plugins" />
	<property name="cfgdir" location="${releasedir}/configuration" />
	<property name="temp" location="${basedir}/temp" />
	
	<!-- Specific Arch Configuration -->
	<property name="talend.binary" value="TalendOpenStudio" />
	<property name="eclipseBaseURL" value="/root/eclipse-gtk" />
	<property name="eclipsebinary" value="eclipse" />
	<property name="los" value="linux" />
	<property name="wm" value="gtk" />
	<property name="cpuf" value="x86" />
	<property name="archi" value="${los}.${wm}.${cpuf}" />
	<property name="confinfo" value="${los},${wm},${cpuf}" />
	
	<!-- Installation Guide Properties -->
	
	<property name="wget.binary" value="wget" />
	<property name="wget.link" value="http://www.talend.com/downloads/download.php?version=b2igl"/>
	<property name="installguide.name" value="install-TOSv100-for-Linux-Unix.pdf"/>
	<property name="installguide.finalname" value="InstallationGuide-TOS.pdf"/>
	<property name="installguide.dlrep" value="${releasedir}" />
	<property name="installguide.finalrep" value="${releasedir}" />
	
	<!-- Set your EclipseHome  here-->
	<property name="eclipsehome" location="${eclipseBaseURL}" />
 	<property name="eclipsehome.feature" location="${eclipsehome}/features" />
	<property name="eclipsehome.plugins" location="${eclipsehome}/plugins" />
		
	<!-- Set Email logger properties her -->
	<property name="MailLogger.mailhost" value="193.252.22.109"/>
	<property name="MailLogger.port" value="25"/>
	<property name="MailLogger.from" value="industrialisation@talend.com"/>
	<property name="MailLogger.replyto" value="jclevenot@talend.com"/>
	<property name="MailLogger.failure.notify" value="yes"/>
	<property name="MailLogger.success.notify" value="yes"/>
	<property name="MailLogger.failure.to" value="ccarbone@talend.com"/>
	<property name="MailLogger.success.to" value="ccarbone@talend.com"/>
	<property name="MailLogger.failure.subject" value="[BUILD LINUX-GTK FAILURE]"/>
	<property name="MailLogger.success.subject" value="[BUILD LINUX-GTK SUCCESS]"/>
	
	<!-- Version property -->
	<property name="versionFile" location="${basedir}/version" />
	<property name="dstampFile" location="${basedir}/dstamp.txt" />
	<property name="about.mappings.file" location="${srcplugins}/org.talend.rcp/about.mappings" />
	<property name="version.mappings" value="1=V1.0.0" />
	
	
	<!-- Initialisation of TimeStamp / DateStamp -->
	<target name="init">
		<echo message="Init task..." />
		<tstamp />
		<echo message="Loading version file" />
		<loadfile property="version" srcFile="${versionFile}" />
		<echo message="Initialisation : TimeStamp / DateStamp" />
		<echo file="${dstampFile}" message="${DSTAMP}-${TSTAMP}-V1" />
		<touch file="${about.mappings.file}"/>
<echo file="${about.mappings.file}">0=${DSTAMP}-${TSTAMP}-V1
${version.mappings}
		</echo>
		</target>
	
	
	<!-- Builds the rcp application -->
	<target name="main">
		<echo message="Building of the project" />
		<antcall target="init"/>
		<antcall target="gen.files" />
		<antcall target="exsd" />
		<antcall target="build.features"/>
		<antcall target="deploy.app" />
		<antcall target="release" />
	</target>
		
	<!-- Cleaning src -->
	<target name="clean.src" description="Cleaning features/plugins after a build process">
		<echo message="Cleaning SRC task in progress..." />
		<antcall target="clean.features" />
		<antcall target="clean.plugins" />
	</target>
	
	<!-- Cleaning sources and directories -->
	<target name="clean.all" description="Clean all the build environnement">
		<echo message="Deleting Builded files task in progress..." />
		<antcall target="clean.src" />
		<delete dir="${releasedir}" />
		<delete dir="${basedir}/workspace" /> 
		<delete file="${dstampFile}" />
		<antcall target="del.genfiles" />
	</target>
			
	<!-- Rebuilds all the application and plugins -->
	<target name="rebuild.all" description="Clean, build, release the product">
		<antcall target="clean.all" />
		<antcall target="main" />
	</target>
	
	<!-- CVS extracting / Building / release / Archive Build and Sources -->
	<target name="do" description="delete sources, checkout sources, build">
		<antcall target="del.src"/>
		<antcall target="checkout"/>
		<antcall target="main" />
		<antcall target="sources" />
		<antcall target="backup" />
		<delete dir="${releasedir}" />
	</target>
	
	<!-- Building a release directory -->
	<target name="release" description="do the product release">
		<antcall target="copy.rcpenv" />
		<antcall target="add.installguide" />
	</target>
	
	<!-- Adding spÃ©cific installation Guide in the product -->
    <target name="add.installguide" description="get installationguide from talend website">
		<exec dir="${installguide.dlrep}" executable="${wget.binary}" >
		  <arg line="${wget.link}"/>
		</exec>
		<move file="${installguide.dlrep}/${installguide.name}" tofile="${installguide.finalrep}/${installguide.finalname}" />
    </target>

		
	<!-- Adding rcp specifics files  -->
	<target name="copy.rcpenv" description="adding rcp env files">
		<echo message="Adding rcp files to the release directory" />
		<echo message="Adding Product Binary" />
		<copy file="${eclipsehome}/${talend.binary}" tofile="${releasedir}/${talend.binary}"/>
		<echo message="Adding startup.jar" />
		<copy file="${eclipsehome}/startup.jar" todir="${releasedir}"/>
		<echo message="Adding .eclipseproduct" />
		<copy file="${src}/.eclipseproduct" todir="${releasedir}"/>
		<echo message="Creating configuration directory and adding config.ini" />
		<mkdir dir="${cfgdir}"/>
		<copy file="${src}/config.ini" todir="${cfgdir}"/>
	</target>
	
	<!-- Generate EXSD Referencial Document in Helpp plugin -->
	<target name="exsd" description="Generate EXSD referencial document">
		<!-- <help.buildHelpIndex manifest="${srcplugins}/org.talend.help/plugin.xml" destination="." />  -->
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.epic.debug/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.epic.perleditor/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.epic.regexp/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.commons/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.core/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.model/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.designer.business.diagram/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.model.edit/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.designer.codegen/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.designer.codegen.perlmodule/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.designer.components.localprovider/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.designer.core/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.designer.mapper/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.designer.runprocess/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.help/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.repository.localprovider/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />
		<pde.convertSchemaToHTML  manifest="${srcplugins}/org.talend.repository/plugin.xml" destination="${srcplugins}/org.talend.help/reference/extension-points/repository/" />

		
	</target>
	
	<!-- Building features from src -->
	<target name="build.features" description="build features">
		<echo message="Building features from src" />
		<ant antfile="${srcfeatures}/org.epic-feature/build.xml" dir="${srcfeatures}/org.epic-feature/" target="build.jars">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			</ant>
		<ant antfile="${basedir}/assemble.org.epic_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="buildDirectory" value="${srcfeatures}/org.epic-feature" />
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.epic-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.epic_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.epic-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.epic-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
			<property name="collectingFolder" value="Talend" />
		</ant>
		<ant antfile="${srcfeatures}/org.talend.commons-feature/build.xml" dir="${srcfeatures}/org.talend.commons-feature/" target="build.jars"/>
		<ant antfile="${basedir}/assemble.org.talend.commons_feature.${archi}.xml" dir="${src}" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.commons-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.commons-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.talend.commons_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.commons-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.commons-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="collectingFolder" value="Talend" />
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${srcfeatures}/org.talend.core-feature/build.xml" dir="${srcfeatures}/org.talend.core-feature/" target="build.jars"/>
		<ant antfile="${basedir}/assemble.org.talend.core_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.core-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.core-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.talend.core_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.core-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.core-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="collectingFolder" value="Talend" />
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${srcfeatures}/org.talend.repository-feature/build.xml" dir="${srcfeatures}/org.talend.repository-feature/" target="build.jars"/>
		<ant antfile="${basedir}/assemble.org.talend.repository_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.repository-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.repository-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.talend.repository_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.repository-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.repository-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="collectingFolder" value="Talend" />
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${srcfeatures}/org.talend.designer-feature/build.xml" dir="${srcfeatures}/org.talend.designer-feature/" target="build.jars"/>
		<ant antfile="${basedir}/assemble.org.talend.designer_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.designer-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.designer-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.talend.designer_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.designer-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.designer-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="collectingFolder" value="Talend" />
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${srcfeatures}/org.talend.designer.business-feature/build.xml" dir="${srcfeatures}/org.talend.designer.business-feature/" target="build.jars"/>
		<ant antfile="${basedir}/assemble.org.talend.designer.business_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.designer.business-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.designer.business-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.talend.designer.business_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.designer.business-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.designer.business-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="collectingFolder" value="Talend" />
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${srcfeatures}/org.talend.rcp-feature/build.xml" dir="${srcfeatures}/org.talend.rcp-feature/" target="build.jars"/>
		<ant antfile="${basedir}/assemble.org.talend.rcp_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.rcp-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.rcp-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.talend.rcp_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.rcp-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.rcp-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
			<property name="collectingFolder" value="Talend" />
		</ant>
		<ant antfile="${srcfeatures}/org.talend.help-feature/build.xml" dir="${srcfeatures}/org.talend.help-feature/" target="build.jars"/>
		<ant antfile="${basedir}/assemble.org.talend.help_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.help-feature" />
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.help-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
		</ant>
		<ant antfile="${basedir}/package.org.talend.help_feature.${archi}.xml" dir="${src}/" target="main">
			<property name="arch" value="${cpuf}"/>
			<property name="os" value="${los}"/>
			<property name="ws" value="${wm}"/>
			<property name="buildDirectory" value="${srcfeatures}/org.talend.help-feature"/>
			<property name="buildId" value="0.0.1"/>
			<property name="buildLabel" value="org.talend.help-feature" />
			<property name="archivePrefix" value="Talend"/>
			<property name="baseLocation" value="${eclipsehome}"/>
			<property name="collectingFolder" value="Talend" />
		</ant>
	</target>
		
	<!-- Deploy Builded features -->
	<target name="deploy.app" description="unjar features">
		<echo message="Deploying features" />
		<move file="${src}/org.talend.commons-feature/org.talend.commons_feature-0.0.1-${archi}.zip" todir="${basedir}" />
		<move file="${src}/org.talend.core-feature/org.talend.core_feature-0.0.1-${archi}.zip" todir="${basedir}" />
		<move file="${src}/org.talend.designer-feature/org.talend.designer_feature-0.0.1-${archi}.zip" todir="${basedir}" />
		<move file="${src}/org.talend.rcp-feature/org.talend.rcp_feature-0.0.1-${archi}.zip" todir="${basedir}" />
		<move file="${src}/org.talend.help-feature/org.talend.help_feature-0.0.1-${archi}.zip" todir="${basedir}" />
		<move file="${src}/org.talend.designer.business-feature/org.talend.designer.business_feature-0.0.1-${archi}.zip" todir="${basedir}" />
		<move file="${src}/org.talend.repository-feature/org.talend.repository_feature-0.0.1-${archi}.zip" todir="${basedir}" />
		<move file="${src}/org.epic-feature/org.epic_feature-0.0.1-${archi}.zip" todir="${basedir}" />

		<unzip src="${basedir}/org.talend.commons_feature-0.0.1-${archi}.zip" dest="${basedir}" />
		<unzip src="${basedir}/org.talend.core_feature-0.0.1-${archi}.zip" dest="${basedir}" />
		<unzip src="${basedir}/org.talend.designer_feature-0.0.1-${archi}.zip" dest="${basedir}" />
		<unzip src="${basedir}/org.talend.rcp_feature-0.0.1-${archi}.zip" dest="${basedir}" />
		<unzip src="${basedir}/org.talend.help_feature-0.0.1-${archi}.zip" dest="${basedir}" />
		<unzip src="${basedir}/org.talend.designer.business_feature-0.0.1-${archi}.zip" dest="${basedir}" />
		<unzip src="${basedir}/org.talend.repository_feature-0.0.1-${archi}.zip" dest="${basedir}" />
		<unzip src="${basedir}/org.epic_feature-0.0.1-${archi}.zip" dest="${basedir}" />	
		
		<delete dir="${src}/org.talend.commons-feature" />
		<delete dir="${src}/org.talend.core-feature" />
		<delete dir="${src}/org.talend.designer-feature" />
		<delete dir="${src}/org.talend.rcp-feature" />
		<delete dir="${src}/org.talend.help-feature" />
		<delete dir="${src}/org.talend.designer.business-feature" />
		<delete dir="${src}/org.talend.repository-feature" />
		<delete dir="${src}/org.epic-feature" />
	</target>
	
	<!-- Cleaning features from src -->
	<target name="clean.features" description="clean builded features temporary files">
		<echo message="Cleaning features" />
		<ant antfile="${srcfeatures}/org.epic-feature/build.xml" dir="${srcfeatures}/org.epic-feature/" target="clean" />
		<ant antfile="${srcfeatures}/org.talend.commons-feature/build.xml" dir="${srcfeatures}/org.talend.commons-feature/" target="clean"/>
		<ant antfile="${srcfeatures}/org.talend.core-feature/build.xml" dir="${srcfeatures}/org.talend.core-feature/" target="clean"/>
		<ant antfile="${srcfeatures}/org.talend.designer-feature/build.xml" dir="${srcfeatures}/org.talend.designer-feature/" target="clean"/>
		<ant antfile="${srcfeatures}/org.talend.rcp-feature/build.xml" dir="${srcfeatures}/org.talend.rcp-feature/" target="clean" />
		<ant antfile="${srcfeatures}/org.talend.help-feature/build.xml" dir="${srcfeatures}/org.talend.help-feature/" target="clean"/>
		<ant antfile="${srcfeatures}/org.talend.designer.business-feature/build.xml" dir="${srcfeatures}/org.talend.designer.business-feature/" target="clean"/>
		<ant antfile="${srcfeatures}/org.talend.repository-feature/build.xml" dir="${srcfeatures}/org.talend.repository-feature/" target="clean"/>
				
		<delete file="${basedir}/org.talend.commons_feature-0.0.1-${archi}.zip" />
		<delete file="${basedir}/org.talend.core_feature-0.0.1-${archi}.zip" />
		<delete file="${basedir}/org.talend.designer_feature-0.0.1-${archi}.zip" />
		<delete file="${basedir}/org.talend.rcp_feature-0.0.1-${archi}.zip" />
		<delete file="${basedir}/org.talend.help_feature-0.0.1-${archi}.zip" />
		<delete file="${basedir}/org.talend.designer.business_feature-0.0.1-${archi}.zip" />
		<delete file="${basedir}/org.talend.repository_feature-0.0.1-${archi}.zip" />
		<delete file="${basedir}/org.epic_feature-0.0.1-${archi}.zip" />
	</target>
	
	<!-- Cleaning plugins from src -->
	<target name="clean.plugins" description="clean builded plugins temporary files">
		<echo message="Cleaning plugins from src" />		
		<ant antfile="${srcplugins}/org.talend.libraries/build.xml" dir="${srcplugins}/org.talend.libraries/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.commons/build.xml" dir="${srcplugins}/org.talend.commons/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.core/build.xml" dir="${srcplugins}/org.talend.core/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.designer.components.localprovider/build.xml" dir="${srcplugins}/org.talend.designer.components.localprovider/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.designer.core/build.xml" dir="${srcplugins}/org.talend.designer.core/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.designer.mapper/build.xml" dir="${srcplugins}/org.talend.designer.mapper/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.designer.codegen/build.xml" dir="${srcplugins}/org.talend.designer.codegen" target="clean" />
		<ant antfile="${srcplugins}/org.talend.designer.codegen.perlmodule/build.xml" dir="${srcplugins}/org.talend.designer.codegen.perlmodule" target="clean" />
		<ant antfile="${srcplugins}/org.talend.resources/build.xml" dir="${srcplugins}/org.talend.resources/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.rcp/build.xml" dir="${srcplugins}/org.talend.rcp/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.help/build.xml" dir="${srcplugins}/org.talend.help/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.designer.runprocess/build.xml" dir="${srcplugins}/org.talend.designer.runprocess/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.designer.business.diagram/build.xml" dir="${srcplugins}/org.talend.designer.business.diagram/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.model/build.xml" dir="${srcplugins}/org.talend.model/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.model.edit/build.xml" dir="${srcplugins}/org.talend.model.edit/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.repository.localprovider/build.xml" dir="${srcplugins}/org.talend.repository.localprovider/" target="clean"/>
		<ant antfile="${srcplugins}/org.talend.repository/build.xml" dir="${srcplugins}/org.talend.repository/" target="clean"/>
		<ant antfile="${srcplugins}/org.epic.debug/build.xml" dir="${srcplugins}/org.epic.debug/" target="clean"/>
		<ant antfile="${srcplugins}/org.epic.perleditor/build.xml" dir="${srcplugins}/org.epic.perleditor/" target="clean"/>
		<ant antfile="${srcplugins}/org.epic.regexp/build.xml" dir="${srcplugins}/org.epic.regexp/" target="clean"/>		
	</target>
	
	<!-- Generates .cvspass in the User's Home -->
	<target name="cvspass" description="generate .cvspass file">
		<cvspass cvsroot=":pserver:indus@monet.talend.com:/TALENDSTUDIO" password="talendindus" />
	</target>
	
	<target name="checkout" description="checkout sources from cvs server">
		<echo message="Acquiering sources from CVS" />
		<antcall target="checkoutfeature" description="checkout features from cvs"/>
		<antcall target="checkoutplugins" description="checkout plugins from cvs" />
	</target>
	
	<!--Checkout features from CVS (using .cvspass in user's home directory) -->
	<target name="checkoutfeature" description="checkout features from cvs">
		<echo message="Acquiering features' sources from CVS" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.commons-feature" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.core-feature" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer-feature" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.rcp-feature" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.help-feature" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.business-feature" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.repository-feature" />
		<cvs command="export" dest="${srcfeatures}" passfile="/root/.cvspass" tag="HEAD" package="org.epic-feature" />
	</target>
	
	<!--Checkout plugins from CVS (using .cvspass in user's home directory) -->
	<target name="checkoutplugins" description="checkout plugins from cvs">
		<echo message="Acquiering plugins' sources from CVS" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.commons" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.core" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.components.localprovider" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.core" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.mapper" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.libraries" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.codegen" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.rcp" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.resources" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.help" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.runprocess" />		
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.model" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.business.diagram" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.model.edit" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.designer.codegen.perlmodule" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.repository.localprovider" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.talend.repository" />		
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.epic.debug" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.epic.perleditor" />
		<cvs command="export" dest="${srcplugins}" passfile="/root/.cvspass" tag="HEAD" package="org.epic.regexp" />
	</target>
	
	<!-- Deleting local sources checkouted from cvs -->
	<target name="del.src" description="delete sources">
		<antcall target="del.srcfeatures" description="delete checkouted features"/>
		<antcall target="del.srcplugins" description="delete checkouted plugins"/>
	</target>
	
	<!-- Deleting local features' sources checkouted from cvs -->
	<target name="del.srcfeatures" description="delete checkouted features" >
		<echo message="Deleting features' sources from src" />
		<delete dir="${srcfeatures}/org.talend.commons-feature" />
		<delete dir="${srcfeatures}/org.talend.rcp-feature" />
		<delete dir="${srcfeatures}/org.talend.core-feature" />
		<delete dir="${srcfeatures}/org.talend.help-feature" />
		<delete dir="${srcfeatures}/org.talend.designer-feature" />
		<delete dir="${srcfeatures}/org.talend.designer.business-feature" />
		<delete dir="${srcfeatures}/org.talend.repository-feature" />
		<delete dir="${srcfeatures}/org.epic-feature" />
	</target>
	
	<!-- Deleting local plugins' sources checkouted from cvs -->
	<target name="del.srcplugins" description="delete checkouted plugins">
		<echo message="Deleting plugins' sources from src" />
	    <delete dir="${srcplugins}/org.talend.commons" /> 
		<delete dir="${srcplugins}/org.talend.core" />
	    <delete dir="${srcplugins}/org.talend.designer.components.localprovider" />
	    <delete dir="${srcplugins}/org.talend.designer.core" />
		<delete dir="${srcplugins}/org.talend.designer.mapper" />
		<delete dir="${srcplugins}/org.talend.libraries" />
		<delete dir="${srcplugins}/org.talend.rcp" />
		<delete dir="${srcplugins}/org.talend.resources" />
		<delete dir="${srcplugins}/org.talend.help" />
		<delete dir="${srcplugins}/org.talend.designer.codegen" />
		<delete dir="${srcplugins}/org.talend.designer.runprocess" />
		<delete dir="${srcplugins}/org.talend.model" />
		<delete dir="${srcplugins}/org.talend.designer.business.diagram" />
		<delete dir="${srcplugins}/org.talend.model.edit" />
		<delete dir="${srcplugins}/org.talend.designer.codegen.perlmodule" />
		<delete dir="${srcplugins}/org.talend.repository.localprovider" />
		<delete dir="${srcplugins}/org.talend.repository" />
		<delete dir="${srcplugins}/org.epic.debug" />
		<delete dir="${srcplugins}/org.epic.perleditor" />
		<delete dir="${srcplugins}/org.epic.regexp" />	
	</target>

	
	<!-- Generate build.xml / javaCompiler...args for features and plugins in local src directory -->
	<target name="gen.files" description="Generate build.xml / javaCompiler...args for features and plugins in local src directory">
		<echo message="Generate files in local src" />
		<antcall target="gen.ffeatures" />
		<antcall target="gen.fplugins" description="generate files for plugins"/>
	</target>
		
	<!-- Generate build.xml for features in local src directory -->
	<target name="gen.ffeatures" description="Generate build.xml for features in local src directory">
		<echo message="Generate features' build.xml in local src" />
		<loadfile property="qualifier" srcFile="${dstampFile}" failonerror="true"/>
		<eclipse.buildScript elements="feature@org.epic_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}" /> 
		<eclipse.buildScript elements="feature@org.talend.commons_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}"/> 	
		<eclipse.buildScript elements="feature@org.talend.rcp_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" product="/org.talend.rcp/org.talend.rcp/talend.product" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}" />
		<eclipse.buildScript elements="feature@org.talend.core_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}"/> 
		<eclipse.buildScript elements="feature@org.talend.help_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="feature@org.talend.designer_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}"/> 
		<eclipse.buildScript elements="feature@org.talend.designer.business_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}"/> 
		<eclipse.buildScript elements="feature@org.talend.repository_feature" buildDirectory="${src}" baseLocation="${eclipsehome}" children="true" forcecontextqualifier="${qualifier}" generatefeatureversionsuffix="no" configInfo="${confinfo}" outputUpdateJars="${bupdatesite}"/> 
		<move todir="${basedir}">
			<fileset dir="${src}" includes="*org.*.xml" />
		</move> 
	</target>
	
	<!-- Generate build.xml / javaCompiler...args for plugins in local src directory -->
	<target name="gen.fplugins" description="Generate build.xml / javaCompiler...args for plugins in local src directory">
		<echo message="Generate plugins' build.xml/javaCompiler...args in local src" />
		<loadfile property="qualifier" srcFile="${dstampFile}" failonerror="true"/>
		<eclipse.buildScript elements="plugin@org.talend.commons" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true" outputUpdateJars="${bupdatesite}" /> 
		<eclipse.buildScript elements="plugin@org.talend.core" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.designer.core" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/> 
		<eclipse.buildScript elements="plugin@org.talend.designer.mapper" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.designer.codegen" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/> 
		<eclipse.buildScript elements="plugin@org.talend.designer.codegen.perlmodule" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/> 
		<eclipse.buildScript elements="plugin@org.talend.designer.runprocess" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.resources" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.designer.components.localprovider" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.help" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.model" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.designer.business.diagram" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.model.edit" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.libraries" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.talend.rcp" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.epic.debug" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.epic.perleditor" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
		<eclipse.buildScript elements="plugin@org.epic.regexp" buildDirectory="${src}" forcecontextqualifier="${qualifier}" baseLocation="${eclipsehome}" children="true"  outputUpdateJars="${bupdatesite}"/>
	</target>
	
	<!-- Delete generated build.xml / javaCompiler...args for features and plugins in local src directory -->
	<target name="del.genfiles" description="Delete generated build.xml / javaCompiler...args for features and plugins in local src directory">
		<echo message="Deleting generated files from local src" />
		<antcall target="del.fgenbuild" description="delete generated files for features"/>
		<antcall target="del.pgenbuild" description="delete generated files for plugins"/>
	</target>
	
	<!-- Delete generated build.xml for features in local src directory -->
	<target name="del.fgenbuild" description="delete generated build.xml for features in local src directory">
		<echo message="Deleting features' build.xml from local src" />
		<delete file="${srcfeatures}/org.talend.commons-feature/build.xml" />
		<delete file="${srcfeatures}/org.talend.core-feature/build.xml" />
		<delete file="${srcfeatures}/org.talend.designer-feature/build.xml" />
		<delete file="${srcfeatures}/org.talend.rcp-feature/build.xml" />
		<delete file="${srcfeatures}/org.talend.help-feature/build.xml" />
		<delete file="${srcfeatures}/org.talend.designer.business-feature/build.xml" />
		<delete file="${srcfeatures}/org.talend.repository-feature/build.xml" />
		<delete file="${srcfeatures}/org.epic-feature/build.xml" />
		
		<delete file="${basedir}/assemble.org.talend.commons_feature.all.xml"/>
		<delete file="${basedir}/assemble.org.talend.commons_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.talend.core_feature.all.xml" />
		<delete file="${basedir}/assemble.org.talend.core_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.talend.designer_feature.all.xml" />
		<delete file="${basedir}/assemble.org.talend.designer_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.talend.rcp_feature.all.xml" />
		<delete file="${basedir}/assemble.org.talend.rcp_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.talend.help_feature.all.xml" />
		<delete file="${basedir}/assemble.org.talend.help_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.talend.designer.business_feature.all.xml" />
		<delete file="${basedir}/assemble.org.talend.designer.business_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.talend.repository_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.talend.repository_feature.all.xml" />
		<delete file="${basedir}/assemble.org.epic_feature.${archi}.xml" />
		<delete file="${basedir}/assemble.org.epic_feature.all.xml" />
			
		<delete file="${basedir}/package.org.talend.commons_feature.all.xml" />
		<delete file="${basedir}/package.org.talend.commons_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.talend.core_feature.all.xml" />
		<delete file="${basedir}/package.org.talend.core_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.talend.designer_feature.all.xml" />
		<delete file="${basedir}/package.org.talend.designer_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.talend.rcp_feature.all.xml" />
		<delete file="${basedir}/package.org.talend.rcp_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.talend.help_feature.all.xml" />
		<delete file="${basedir}/package.org.talend.help_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.talend.designer.business_feature.all.xml" />
		<delete file="${basedir}/package.org.talend.designer.business_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.talend.repository_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.talend.repository_feature.all.xml" />
		<delete file="${basedir}/package.org.epic_feature.${archi}.xml" />
		<delete file="${basedir}/package.org.epic_feature.all.xml" />
	</target>
	
	<!-- Delete generated build.xml and javaCompiler...args for plugins in local src directory -->
	<target name="del.pgenbuild" description="delete generated build.xml and javaCompiler...args for plugins in local src directory">
		<echo message="Deleting plugins' build.xml/javaCompiler...args from local src" />
		<delete file="${srcplugins}/org.talend.libraries/build.xml" />
		<delete file="${srcplugins}/org.talend.commons/build.xml" />
		<delete file="${srcplugins}/org.talend.core/build.xml" />
		<delete file="${srcplugins}/org.talend.designer.components.localprovider/build.xml" />
		<delete file="${srcplugins}/org.talend.designer.core/build.xml" />
		<delete file="${srcplugins}/org.talend.designer.mapper/build.xml" />
		<delete file="${srcplugins}/org.talend.rcp/build.xml" />
		<delete file="${srcplugins}/org.talend.resources/build.xml" />
		<delete file="${srcplugins}/org.talend.designer.codegen/build.xml" />
		<delete file="${srcplugins}/org.talend.help/build.xml" />
		<delete file="${srcplugins}/org.talend.designer.runprocess/build.xml" />
		<delete file="${srcplugins}/org.talend.designer.codegen.perlmodule/build.xml" />
		<delete file="${srcplugins}/org.talend.model/build.xml" />
		<delete file="${srcplugins}/org.talend.designer.business.diagram/build.xml" />
		<delete file="${srcplugins}/org.talend.model.edit/build.xml" />
		<delete file="${srcplugins}/org.talend.repository.localprovider/build.xml" />
		<delete file="${srcplugins}/org.talend.repository/build.xml" />
		<delete file="${srcplugins}/org.epic.debug/build.xml" />
		<delete file="${srcplugins}/org.epic.perleditor/build.xml" />
		<delete file="${srcplugins}/org.epic.regexp/build.xml" />
			
		<delete file="${srcplugins}/org.talend.libraries/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.commons/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.core/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.designer.components.localprovider/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.designer.core/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.designer.mapper/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.rcp/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.resources/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.designer.codegen/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.help/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.designer.runprocess/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.designer.codegen.perlmodule/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.model/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.designer.business.diagram/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.model.edit/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.repository/javaCompiler...args" />
		<delete file="${srcplugins}/org.talend.repository.localprovider/javaCompiler...args" />
		<delete file="${srcplugins}/org.epic.debug/javaCompiler...args" />
		<delete file="${srcplugins}/org.epic.perleditor/javaCompiler...args" />
		<delete file="${srcplugins}/org.epic.regexp/javaCompiler...args" />
	</target>
	
	
	<target name="sources" description="Save All sources used to build in a zip">
 		<antcall target="clean.src"  />
		<delete dir="${basedir}/workspace" /> 
		<antcall target="del.genfiles" />
	    <loadfile property="buildID" srcFile="${dstampFile}" failonerror="true"/>
		<echo message="${buildID}"/>
		<mkdir dir="${storage}"/>
		<mkdir dir="${storage.sources}"/>
		<mkdir dir="${storage.sources}/${storage.sources.dirname}-${buildID}" />
		<zip destfile="${storage.sources}/${storage.sources.dirname}-${buildID}/${storage.sources.filename}-${buildID}.zip" basedir="${src}"/>
	</target>
	
	<target name="backup" description="Save the builded product in a zip">
		<echo message="Deleting Builded files task in progress..." />
		<loadfile property="buildID" srcFile="${dstampFile}" failonerror="true"/>
		<echo message="${buildID}"/>
		<mkdir dir="${temp}" />
		<mkdir dir="${storage}"/>
		<mkdir dir="${storage.builds}"/>
		<mkdir dir="${storage.builds}/${storage.builds.dirname}-${storage.builds.os}.${wm}-${buildID}"/>
		<mkdir dir="${temp}/${storage.builds.dirname}-${storage.builds.os}.${wm}-${buildID}"/>
		<move todir="${temp}/${storage.builds.dirname}-${storage.builds.os}.${wm}-${buildID}">
		   <fileset dir="${releasedir}" />
		  </move>
		<zip destfile="${storage.builds}/${storage.builds.dirname}-${storage.builds.os}.${wm}-${buildID}/${storage.builds.filename}-${storage.builds.os}.${wm}-${buildID}.zip" basedir="${temp}/"/>
		<move todir="${releasedir}">
			<fileset dir="${temp}/${storage.builds.dirname}-${storage.builds.os}.${wm}-${buildID}" />
		</move>
	</target>

<target name="clean.storage">
	
	<echo message="Deleting old builds and backup the last one" />
	<loadfile property="buildID" srcFile="${dstampFile}" failonerror="true"/>
	<echo message="${buildID}"/>
	<move todir="${backup.builds}/${storage.builds.dirname}-${storage.builds.os}.${wm}-${buildID}" includeEmptyDirs="yes" failonerror="true" >
		<fileset dir="${storage.builds}/${storage.builds.dirname}-${storage.builds.os}.${wm}-${buildID}" />
	</move>
	<move todir="${backup.sources}/${storage.sources.dirname}-${buildID}" includeEmptyDirs="yes" failonerror="true">
		<fileset dir="${storage.sources}/${storage.sources.dirname}-${buildID}" />
	</move>
	<delete dir="${storage.builds}" includeemptydirs="true"/>
	<delete dir="${storage.sources}" includeemptydirs="true" />
	<mkdir dir="${storage.builds}" />
	<mkdir dir="${storage.sources}" />
</target>
	
	<target name="javadoc">
		<!-- adding ant call to javadoc.xml generated with eclipse -->
	</target>

</project>
